```sh
$ ssh -p 2226 narnia7@narnia.labs.overthewire.org
```

password: ahkiaziphu

hackedfunction(\x06\x87\x04\x08)に飛ばす


"A"\*140
```
gdb-peda$ x/100wx $esp
0xffffbdd0: 0xffffbdf0  0x00000080  0xffffc1f6  0xffffbe48
0xffffbde0: 0xf7ffda74  0x00000001  0xf7fd4b48  0x080486e0 <- addr of goodfunction()
0xffffbdf0: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffbe00: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffbe10: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffbe20: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffbe30: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffbe40: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffbe50: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffbe60: 0x41414141  0x41414141  0x41414141  0x00414141
0xffffbe70: 0x00000002  0xffffbf34  0xffffbe98  0x080486d8
```

format string attack

"A" * 4

```
gdb-peda$ x/100wx $esp
0xffffbe50: 0xffffbe70  0x00000080  0xffffc27e  0xffffbec8
0xffffbe60: 0xf7ffda74  0x00000001  0xf7fd4b48  0x080486e0
0xffffbe70: 0x00000000  0x00000000  0x00000000  0x00000000
```

after snprintf()

```
gdb-peda$ x/100wx $esp
0xffffbe50: 0xffffbe70  0x00000080  0xffffc27e  0xffffbec8
0xffffbe60: 0xf7ffda74  0x00000001  0xf7fd4b48  0x080486e0
0xffffbe70: 0x41414141  0x00000000  0x00000000  0x00000000
```
